<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Will You Be My Valentine? üíù</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@300;400;600&display=swap"
        rel="stylesheet">

    <!-- Canvas Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        :root {
            --primary-pink: #ff69b4;
            --primary-red: #ff4d4d;
        }

        body {
            font-family: 'Poppins', sans-serif;
            overflow: hidden;
            touch-action: none;
            background: linear-gradient(135deg, #ffafbd 0%, #ffc3a0 100%);
        }

        .script-font {
            font-family: 'Dancing Script', cursive;
        }

        /* Floating Elements (Hearts & Bears) */
        .floating-element {
            position: absolute;
            z-index: 0;
            pointer-events: none;
            user-select: none;
            animation: float 15s infinite linear;
        }

        @keyframes float {
            0% {
                transform: translateY(110vh) rotate(0deg);
                opacity: 1;
            }

            100% {
                transform: translateY(-10vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* Fade transitions */
        .fade-in {
            animation: fadeIn 0.8s ease-out forwards;
        }

        .fade-out {
            animation: fadeOut 0.5s ease-in forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
                transform: translateY(0);
            }

            to {
                opacity: 0;
                transform: translateY(-20px);
            }
        }

        /* Glassmorphism */
        .glass {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
        }

        /* Love Meter Slider */
        .slider {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 15px;
            border-radius: 10px;
            background: #ffd1dc;
            outline: none;
            transition: width 0.3s ease;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: var(--primary-pink);
            cursor: pointer;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        #no-btn {
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .heartbeat {
            animation: beat 1.2s infinite;
        }

        @keyframes beat {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }
        }
    </style>
</head>

<body class="h-screen w-screen flex flex-col items-center justify-center relative select-none overflow-hidden">

    <!-- Background Elements Container -->
    <div id="elements-container" class="absolute inset-0 overflow-hidden pointer-events-none"></div>

    <!-- Music Player (Hidden) -->
    <audio id="bg-music" loop>
        <source src="baby.mp3" type="audio/mpeg">
        <!-- Fallback to a sample song if baby.mp3 is missing -->
        <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
    </audio>

    <!-- STAGE 1: The Intro -->
    <div id="intro-card" class="z-10 text-center max-w-sm md:max-w-lg p-10 rounded-3xl glass mx-4">
        <h1 class="text-3xl md:text-4xl text-pink-600 mb-8 font-semibold leading-tight" id="intro-text">
            Hey Beautiful...
        </h1>
        <button onclick="nextStep()"
            class="bg-pink-500 hover:bg-pink-600 text-white font-bold py-4 px-12 rounded-full shadow-lg transform transition active:scale-95 focus:outline-none ring-4 ring-pink-200">
            Click Me
        </button>
    </div>

    <!-- STAGE 2: The Love Meter -->
    <div id="meter-card" class="hidden z-10 text-center w-full max-w-lg p-10 glass rounded-3xl mx-4">
        <h2 class="text-2xl md:text-3xl text-pink-600 mb-6 font-semibold">How much do you love me?</h2>
        <div class="mb-8">
            <input type="range" min="0" max="10000" value="100" class="slider" id="loveSlider">
            <p class="mt-4 text-gray-700 font-medium text-xl">
                Love Level: <span id="loveValue" class="text-pink-600 font-bold">100</span>%
            </p>
            <p id="meter-message" class="mt-2 text-pink-500 italic h-6"></p>
        </div>
        <button id="meter-next"
            class="hidden bg-pink-500 text-white font-bold py-3 px-10 rounded-full shadow-lg fade-in"
            onclick="toProposalStage()">
            Next ‚ù§Ô∏è
        </button>
    </div>

    <!-- STAGE 3: The Question -->
    <div id="proposal-card" class="hidden z-10 text-center w-full max-w-2xl px-6 relative flex flex-col items-center">
        <div class="text-7xl md:text-9xl text-red-500 mb-6 heartbeat drop-shadow-lg">üíù</div>
        <h1 class="script-font text-5xl md:text-7xl text-pink-600 mb-4 leading-tight">
            Will you be my Valentine?
        </h1>
        <p class="text-gray-600 mb-12 text-lg md:text-xl font-medium">
            (I promise to buy you all the chocolate üç´)
        </p>

        <div class="flex flex-col md:flex-row justify-center gap-8 items-center w-full min-h-[150px] relative">
            <button id="yes-btn" onclick="celebrate()"
                class="bg-green-500 hover:bg-green-600 text-white text-2xl font-bold py-4 px-12 rounded-full shadow-xl transform transition z-30 order-1 md:order-none">
                YES!
            </button>
            <button id="no-btn"
                class="bg-gray-400 text-white text-xl font-bold py-4 px-10 rounded-full shadow-lg z-20 order-2 md:order-none">
                No
            </button>
        </div>
    </div>

    <!-- STAGE 4: Celebration -->
    <div id="success-card"
        class="hidden z-40 text-center max-w-sm md:max-w-2xl p-12 glass rounded-3xl shadow-2xl fade-in mx-4">
        <h1 class="text-7xl md:text-9xl mb-8">ü•∞üéâ</h1>
        <h2 class="script-font text-5xl md:text-7xl text-pink-600 mb-8">She said YES!</h2>
        <p class="text-xl md:text-2xl text-gray-700 font-medium leading-relaxed mb-8">
            You just made me the happiest person in the world. <br />
            I love you forever! ‚ù§Ô∏è
        </p>
        <button onclick="location.reload()" class="text-pink-400 hover:text-pink-500 underline text-sm">Play
            Again?</button>
        <div class="mt-8 pt-6 border-t border-pink-100 text-sm text-gray-400">
            Screenshot this and send it to me!
        </div>
    </div>

    <script>
        const messages = [
            "Hey Beautiful...",
            "Just wanted to say...",
            "You are the most amazing person...",
            "But before I continue...",
        ];

        let step = 0;
        let yesScale = 1;
        let noScale = 1;
        let hasStartedMusic = false;

        const music = document.getElementById('bg-music');
        const introCard = document.getElementById('intro-card');
        const introText = document.getElementById('intro-text');
        const meterCard = document.getElementById('meter-card');
        const proposalCard = document.getElementById('proposal-card');
        const successCard = document.getElementById('success-card');

        const loveSlider = document.getElementById('loveSlider');
        const loveValue = document.getElementById('loveValue');
        const meterMessage = document.getElementById('meter-message');
        const meterNext = document.getElementById('meter-next');

        const noBtn = document.getElementById('no-btn');
        const yesBtn = document.getElementById('yes-btn');

        function startMusic() {
            if (!hasStartedMusic) {
                music.play().catch(e => console.log("Music blocked: ", e));
                hasStartedMusic = true;
            }
        }

        function nextStep() {
            startMusic();
            step++;
            introText.classList.add('fade-out');

            setTimeout(() => {
                if (step < messages.length) {
                    introText.innerText = messages[step];
                    introText.classList.remove('fade-out');
                    introText.classList.add('fade-in');
                    setTimeout(() => introText.classList.remove('fade-in'), 800);
                } else {
                    introCard.classList.add('hidden');
                    meterCard.classList.remove('hidden');
                    meterCard.classList.add('fade-in');
                }
            }, 500);
        }

        // Love Meter Logic
        let isInverted = false;
        let totalLove = 100;
        let lastSliderValue = 100;
        const maxVal = 10000;

        loveSlider.addEventListener('input', (e) => {
            let currentVal = parseInt(e.target.value);

            if (!isInverted) {
                // --- Normal Mode (Dragging Right) ---
                if (currentVal < lastSliderValue) {
                    // Pull back detected! Flip everything.
                    isInverted = true;
                    // Adjust value so thumb stays under finger/cursor
                    currentVal = maxVal - currentVal;
                    loveSlider.value = currentVal;
                    loveSlider.style.transform = 'scaleX(-1)';
                    meterMessage.innerText = "No going back! Love grows both ways! üòâ";
                } else {
                    totalLove = currentVal;
                    if (totalLove > 5000) meterMessage.innerText = "Keep going to the edge! ‚û°Ô∏è";
                }

                if (currentVal >= maxVal) showProceed();
            } else {
                // --- Inverted Mode (Dragging Left INCREASES Value) ---
                // In scaleX(-1) mode, dragging to the left increases the slider 'value' 
                totalLove = maxVal + currentVal * 10;
                meterMessage.innerText = "All the way to the left now! ‚¨ÖÔ∏è";

                if (currentVal >= maxVal) showProceed();
            }

            lastSliderValue = parseInt(loveSlider.value);

            // Format and Display
            if (totalLove >= 100000) {
                loveValue.innerText = "‚àû";
                meterMessage.innerText = "INFINITY REACHED! ‚ù§Ô∏è";
            } else {
                loveValue.innerText = totalLove.toLocaleString();
            }

            // Visual expansion effect
            const expansion = Math.min(600, (totalLove / 100));
            loveSlider.style.width = `calc(100% + ${expansion}px)`;
        });

        function showProceed() {
            loveValue.innerText = "‚àû";
            meterMessage.innerText = "BEYOND INFINITY! ‚ù§Ô∏è";
            meterNext.classList.remove('hidden');
            meterNext.classList.add('fade-in');
            loveSlider.disabled = true;
        }

        function toProposalStage() {
            meterCard.classList.add('hidden');
            proposalCard.classList.remove('hidden');
            proposalCard.classList.add('fade-in');
            initDodgeLogic();
        }

        function initDodgeLogic() {
            const dodge = (e) => {
                const rect = noBtn.getBoundingClientRect();
                const padding = 20;

                const clientX = e.touches ? e.touches[0].clientX : e.clientX;
                const clientY = e.touches ? e.touches[0].clientY : e.clientY;

                const maxX = window.innerWidth - rect.width - padding;
                const maxY = window.innerHeight - rect.height - padding;

                let newX, newY;
                let attempts = 0;

                do {
                    newX = Math.random() * maxX;
                    newY = Math.random() * maxY;
                    attempts++;
                } while (
                    Math.abs(newX + rect.width / 2 - clientX) < 150 &&
                    Math.abs(newY + rect.height / 2 - clientY) < 150 &&
                    attempts < 30
                );

                noBtn.style.position = 'fixed';
                noBtn.style.left = `${newX}px`;
                noBtn.style.top = `${newY}px`;

                yesScale += 0.2;
                noScale = Math.max(0.4, noScale - 0.1);

                yesBtn.style.transform = `scale(${yesScale})`;
                noBtn.style.transform = `scale(${noScale})`;
            };

            noBtn.addEventListener('pointerenter', dodge);
            noBtn.addEventListener('touchstart', (e) => {
                e.preventDefault();
                dodge(e);
            });
            noBtn.addEventListener('click', (e) => {
                e.preventDefault();
                dodge(e);
            });
        }

        function celebrate() {
            proposalCard.classList.add('hidden');
            successCard.classList.remove('hidden');

            const duration = 10 * 1000;
            const animationEnd = Date.now() + duration;
            const defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };

            function randomInRange(min, max) {
                return Math.random() * (max - min) + min;
            }

            const interval = setInterval(function () {
                const timeLeft = animationEnd - Date.now();

                if (timeLeft <= 0) {
                    return clearInterval(interval);
                }

                const particleCount = 50 * (timeLeft / duration);
                confetti({ ...defaults, particleCount, origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 }, colors: ['#ff69b4', '#ff0000'], shapes: ['heart'] });
                confetti({ ...defaults, particleCount, origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 }, colors: ['#ff69b4', '#ff0000'], shapes: ['heart'] });
            }, 250);
        }

        function spawnElements() {
            const container = document.getElementById('elements-container');
            const emojis = ['‚ù§Ô∏è', 'üíñ', 'üß∏', 'üåπ', '‚ú®', 'üêª'];

            function create() {
                const el = document.createElement('div');
                el.className = 'floating-element text-2xl';
                el.innerText = emojis[Math.floor(Math.random() * emojis.length)];
                el.style.left = Math.random() * 100 + 'vw';
                el.style.fontSize = (Math.random() * 20 + 20) + 'px';
                el.style.animationDuration = (Math.random() * 10 + 10) + 's';
                el.style.opacity = Math.random() * 0.4 + 0.3;

                container.appendChild(el);
                setTimeout(() => el.remove(), 15000);
            }

            setInterval(create, 500);
            for (let i = 0; i < 8; i++) setTimeout(create, Math.random() * 5000);
        }

        spawnElements();
    </script>
</body>

</html>