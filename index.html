<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>A Question for You...</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

    <!-- Canvas Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        :root {
            --primary-pink: #ff69b4;
            --primary-red: #ff4d4d;
        }

        body {
            font-family: 'Poppins', sans-serif;
            overflow: hidden;
            touch-action: none; /* Prevent pull-to-refresh and other gestures */
        }

        .script-font {
            font-family: 'Great Vibes', cursive;
        }

        /* Floating Hearts Background */
        .floating-heart {
            position: absolute;
            color: rgba(255, 182, 193, 0.6);
            animation: float 15s infinite linear;
            z-index: 0;
            pointer-events: none;
            user-select: none;
        }

        @keyframes float {
            0% { transform: translateY(110vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-10vh) rotate(360deg); opacity: 0; }
        }

        /* Fade transitions */
        .fade-in { animation: fadeIn 0.8s ease-out forwards; }
        .fade-out { animation: fadeOut 0.5s ease-in forwards; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeOut {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(-20px); }
        }

        /* Pulse */
        .heartbeat { animation: beat 1.2s infinite; }
        @keyframes beat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.15); }
        }

        /* Glassmorphism utility */
        .glass {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 192, 203, 0.3);
        }

        #no-btn {
            transition: transform 0.1s ease-out, left 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), top 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            will-change: left, top, transform;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-pink-100 via-red-50 to-pink-200 h-screen w-screen flex flex-col items-center justify-center relative select-none overflow-hidden">

    <!-- Background Decoration -->
    <div id="hearts-container" class="absolute inset-0 overflow-hidden pointer-events-none"></div>

    <!-- STAGE 1: The Intro -->
    <div id="intro-card" class="z-10 text-center max-w-sm md:max-w-lg p-8 rounded-3xl shadow-xl glass transition-all duration-700 mx-4">
        <h1 class="text-3xl md:text-4xl text-pink-600 mb-6 font-semibold" id="intro-text">
            Hey Beautiful...
        </h1>
        <button onclick="nextStep()" class="bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 px-10 rounded-full shadow-lg transform transition active:scale-95 focus:outline-none ring-4 ring-pink-200">
            Click Me
        </button>
    </div>

    <!-- STAGE 2: The Question -->
    <div id="question-card" class="hidden z-10 text-center w-full max-w-2xl px-6 py-12 relative flex flex-col items-center">
        <div class="text-7xl md:text-9xl text-red-500 mb-6 heartbeat drop-shadow-lg">‚ù§Ô∏è</div>
        
        <h1 class="script-font text-5xl md:text-7xl text-pink-600 mb-4 leading-tight">
            Will you be my Valentine?
        </h1>
        
        <p class="text-gray-600 mb-12 text-lg md:text-xl font-medium">
            (I promise to buy you chocolate üç´)
        </p>

        <div id="btn-container" class="flex flex-col md:flex-row justify-center gap-6 md:gap-12 items-center w-full min-h-[100px]">
            <button id="yes-btn" onclick="acceptProposal()" class="bg-green-500 hover:bg-green-600 text-white text-2xl font-bold py-4 px-12 rounded-full shadow-xl transform transition hover:scale-105 active:scale-95 ring-4 ring-green-100 z-30 order-1 md:order-none">
                YES!
            </button>

            <button id="no-btn" class="bg-gray-400 text-white text-xl font-bold py-4 px-10 rounded-full shadow-lg pointer-events-auto z-20 order-2 md:order-none">
                No
            </button>
        </div>
    </div>

    <!-- STAGE 3: Success -->
    <div id="success-card" class="hidden z-40 text-center max-w-sm md:max-w-2xl p-10 glass rounded-3xl shadow-2xl border-2 border-pink-200 fade-in mx-4">
        <h1 class="text-6xl md:text-8xl mb-6">ü•∞üéâ</h1>
        <h2 class="script-font text-5xl md:text-7xl text-pink-600 mb-6">She said YES!</h2>
        <p class="text-xl md:text-2xl text-gray-700 font-medium leading-relaxed">
            You just made me the happiest person in the world. <br />
            I love you! ‚ù§Ô∏è
        </p>
        <div class="mt-10 p-4 border-t border-pink-100 text-sm text-gray-400">
            Screenshot this and send it to me!
        </div>
    </div>

    <script>
        const messages = [
            "Hey Beautiful...",
            "Every moment with you is special...",
            "You make my heart skip a beat...",
            "So I have a tiny question...",
        ];

        let step = 0;
        let yesScale = 1;
        const introCard = document.getElementById('intro-card');
        const introText = document.getElementById('intro-text');
        const questionCard = document.getElementById('question-card');
        const successCard = document.getElementById('success-card');
        const noBtn = document.getElementById('no-btn');
        const yesBtn = document.getElementById('yes-btn');

        function nextStep() {
            step++;
            introText.classList.add('fade-out');

            setTimeout(() => {
                if (step < messages.length) {
                    introText.innerText = messages[step];
                    introText.classList.remove('fade-out');
                    introText.classList.add('fade-in');
                    setTimeout(() => introText.classList.remove('fade-in'), 800);
                } else {
                    introCard.classList.add('hidden');
                    questionCard.classList.remove('hidden');
                    questionCard.classList.add('fade-in');
                    initDodgeLogic();
                }
            }, 500);
        }

        function initDodgeLogic() {
            // Enhanced dodge logic for both mouse and touch
            const dodge = (e) => {
                const rect = noBtn.getBoundingClientRect();
                
                // Get interaction point
                const clientX = e.touches ? e.touches[0].clientX : e.clientX;
                const clientY = e.touches ? e.touches[0].clientY : e.clientY;

                // Center of the button
                const btnX = rect.left + rect.width / 2;
                const btnY = rect.top + rect.height / 2;

                // Simple dodge: just teleport to a new random safe spot away from current touch
                // But better: Calculate a random safe zone
                
                const padding = 20;
                const maxX = window.innerWidth - rect.width - padding;
                const maxY = window.innerHeight - rect.height - padding;

                let newX, newY;
                let attempts = 0;
                
                // Try to find a spot that isn't under the finger/cursor
                do {
                    newX = Math.random() * maxX;
                    newY = Math.random() * maxY;
                    attempts++;
                } while (
                    Math.abs(newX + rect.width/2 - clientX) < 150 && 
                    Math.abs(newY + rect.height/2 - clientY) < 150 && 
                    attempts < 20
                );

                noBtn.style.position = 'fixed';
                noBtn.style.left = `${newX}px`;
                noBtn.style.top = `${newY}px`;

                // Grow the YES button
                yesScale += 0.15;
                yesBtn.style.transform = `scale(${yesScale})`;
            };

            // Use pointer events for broad support
            noBtn.addEventListener('pointerover', dodge);
            noBtn.addEventListener('touchstart', (e) => {
                e.preventDefault(); // Prevent accidental clicks
                dodge(e);
            });
            noBtn.addEventListener('click', (e) => {
                e.preventDefault();
                dodge(e);
            });
        }

        function acceptProposal() {
            questionCard.classList.add('hidden');
            successCard.classList.remove('hidden');
            
            // Celebration loop
            const end = Date.now() + (5 * 1000);
            const colors = ['#ff69b4', '#ff4d4d', '#ffffff', '#ffb6c1'];

            (function frame() {
                confetti({
                    particleCount: 3,
                    angle: 60,
                    spread: 55,
                    origin: { x: 0 },
                    colors: colors,
                    shapes: ['heart']
                });
                confetti({
                    particleCount: 3,
                    angle: 120,
                    spread: 55,
                    origin: { x: 1 },
                    colors: colors,
                    shapes: ['heart']
                });

                if (Date.now() < end) {
                    requestAnimationFrame(frame);
                }
            }());
        }

        // Background Hearts
        function createHeart() {
            const container = document.getElementById('hearts-container');
            const heart = document.createElement('div');
            heart.className = 'floating-heart';
            heart.innerHTML = '‚ù§Ô∏è';
            
            const size = Math.random() * 20 + 10;
            heart.style.left = Math.random() * 100 + 'vw';
            heart.style.fontSize = `${size}px`;
            heart.style.animationDuration = (Math.random() * 10 + 10) + 's';
            heart.style.opacity = Math.random() * 0.5 + 0.3;
            
            container.appendChild(heart);
            setTimeout(() => heart.remove(), 15000);
        }

        setInterval(createHeart, 600);
        for(let i=0; i<10; i++) setTimeout(createHeart, Math.random() * 5000);
    </script>
</body>
</html>
